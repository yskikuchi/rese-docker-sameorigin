(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{309:function(t,e,o){var content=o(318);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(56).default)("4073ee00",content,!0,{sourceMap:!1})},315:function(t,e,o){t.exports=o.p+"img/close.0e5cc6d.png"},317:function(t,e,o){"use strict";o(309)},318:function(t,e,o){var n=o(55)(!1);n.push([t.i,".booking_card{width:55%;color:#fff;border-radius:5px;background-color:#4169e1;padding:5px 10px;margin-bottom:20px;position:relative}.booking_card_ttl{font-size:20px;line-height:1.5em}.checked{margin-left:10px;background:#ff6868;padding:3px 6px;border-radius:5px;font-size:15px}.checkout{margin-left:10px;background:#f8a60e;border:none;border-radius:5px;color:#fff}.booking_card table{color:#fff;font-size:1em;padding:10px;margin:5px}.booking_card th{text-align:left;padding:5px 20px 5px 0}.close-btn{height:13%;position:absolute;top:7%;right:5%}.change-booking{display:inline-block;color:#fff;padding:10px}.qr-btn{background-color:inherit;border:none;color:#fff;display:block;font-size:15px}.qrcode-wrapper{position:absolute;top:0;left:0;width:100%;height:100%;background:#fff;z-index:9}.qrcode-content{width:70%;margin:0 auto;color:#000;text-align:center}.qr-close{display:block;margin:0 auto}@media screen and (max-width:768px){.booking_card{width:90%}}",""]),t.exports=n},344:function(t,e,o){"use strict";o.r(e);var n=o(11),r=(o(39),o(303),o(47),o(327)),c={props:{booking:{type:Object},index:{type:Number}},data:function(){return{isShowQR:!1,qrcode:"",sendData:{user_id:this.$auth.user.id,shop_id:this.booking.shop.id,menu_id:this.booking.menu.id,booking_id:this.booking.id,number_of_people:this.booking.number_of_people},processing:!1}},filters:{formatTime:function(time){return time.slice(0,-3)}},mounted:function(){var t=this;r.toDataURL(this.$config.apiURL+"/admin/booking/"+this.booking.id,(function(e,o){if(e)throw e;t.qrcode=o}))},methods:{cancelBooking:function(t,e){var o=this;return Object(n.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!o.processing){n.next=2;break}return n.abrupt("return");case 2:if(!confirm("予約"+e+"を削除してよろしいですか？")){n.next=7;break}return n.next=5,o.$axios.delete("/booking/"+t);case 5:return n.next=7,o.$store.dispatch("getMyBookings");case 7:case"end":return n.stop()}}),n)})))()},toggleIsShowQR:function(){this.isShowQR=!this.isShowQR},checkout:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.processing){e.next=3;break}return e.abrupt("return");case 3:if(!confirm("事前決済ページへ移動しますか？")){e.next=11;break}return t.processing=!0,e.next=7,t.$axios.post("/pay",t.sendData);case 7:return o=e.sent,n=o.data.data.id,e.next=11,t.$stripe.redirectToCheckout({sessionId:n}).then((function(t){console.log(t)}));case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0),t.processing=!1;case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))()}}},d=(o(317),o(27)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",{staticClass:"booking_card",attrs:{booking:t.booking,index:t.index}},[n("span",{staticClass:"booking_card_ttl"},[t._v("予約"+t._s(t.index+1))]),t._v(" "),1==t.booking.checked?n("span",{staticClass:"checked"},[t._v("(支払い済)")]):n("span",[n("button",{staticClass:"checkout",on:{click:t.checkout}},[t._v("事前決済をする")])]),t._v(" "),n("img",{staticClass:"close-btn",attrs:{src:o(315)},on:{click:function(e){return t.cancelBooking(t.booking.id,t.index+1)}}}),t._v(" "),n("table",[n("tr",[n("th",[t._v("Shop")]),t._v(" "),n("td",[t._v(t._s(t.booking.shop.name))])]),t._v(" "),n("tr",[n("th",[t._v("Date")]),t._v(" "),n("td",[t._v(t._s(t.booking.date))])]),t._v(" "),n("tr",[n("th",[t._v("Time")]),t._v(" "),n("td",[t._v(t._s(t._f("formatTime")(t.booking.time)))])]),t._v(" "),n("tr",[n("th",[t._v("Number")]),t._v(" "),n("td",[t._v(t._s(t.booking.number_of_people)+"人")])]),t._v(" "),n("tr",[n("th",[t._v("Menu")]),t._v(" "),n("td",[t._v(t._s(t.booking.menu.name))])])]),t._v(" "),n("NuxtLink",{staticClass:"change-booking",attrs:{to:{path:"bookings/"+t.booking.id}}},[t._v("日時、人数を変更する")]),t._v(" "),n("button",{staticClass:"qr-btn",on:{click:t.toggleIsShowQR}},[t._v("QRコードを表示")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowQR,expression:"isShowQR"}],staticClass:"qrcode-wrapper"},[n("div",{staticClass:"qrcode-content"},[n("p",[t._v("こちらのQRコードを従業員にお見せください")]),t._v(" "),n("img",{attrs:{src:t.qrcode,alt:"QRcode"}}),t._v(" "),n("button",{staticClass:"qr-close",on:{click:t.toggleIsShowQR}},[t._v("閉じる")])])])],1)])}),[],!1,null,null,null);e.default=component.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[14,3],{301:function(t,e,n){t.exports=n.p+"img/heart_gray.3fd39c6.png"},302:function(t,e,n){var content=n(312);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("d9c6e280",content,!0,{sourceMap:!1})},309:function(t,e,n){var content=n(318);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("4073ee00",content,!0,{sourceMap:!1})},310:function(t,e,n){t.exports=n.p+"img/heart_red.56d7c4e.png"},311:function(t,e,n){"use strict";n(302)},312:function(t,e,n){var o=n(55)(!1);o.push([t.i,".card{border-radius:5px;overflow:hidden;background-color:#fff;box-shadow:5px 5px 10px rgba(0,0,0,.3);margin:10px;position:relative}.card-content{padding:10px 20px}.card-img{max-width:100%;height:auto}.card-name{font-weight:700;margin:10px 0}.card-name,.card-tag{font-size:1em}.card-detail-btn{display:inline-block;width:60%;font-size:1em;padding:7px 0;margin-top:20px;text-align:center;text-decoration:none;background:#4169e1;color:#fff;border-radius:5px}.fav-btn{width:18%;cursor:pointer;display:inline-block;position:absolute;bottom:0;right:0}@media screen and (max-width:768px){.card{width:48%!important;margin:5px 0}.card-content{padding:7px 14px}.card-name{margin:5px 0}.card-tag{font-size:10px}.card-detail-btn{margin-top:5px;font-size:10px}.fav-btn{width:22%}}",""]),t.exports=o},314:function(t,e,n){"use strict";n.r(e);var o=n(11),r=(n(39),n(303),{props:{shop:{type:Object},width:{type:Number}},data:function(){return{processing:!1}},filters:{imagePathFormat:function(path,t){return t+"/storage/images/"+path},imagePathFormatProduction:function(path,t){return t+"/"+path}},methods:{favorite:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.processing){n.next=2;break}return n.abrupt("return");case 2:return e.processing=!0,o={user_id:e.$auth.user.id,shop_id:t},n.next=6,e.$axios.post("/favorite",o);case 6:return n.next=8,e.$store.dispatch("getShops");case 8:e.$emit("changeFav"),e.processing=!1;case 10:case"end":return n.stop()}}),n)})))()},unfavorite:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.processing){n.next=2;break}return n.abrupt("return");case 2:return e.processing=!0,n.next=5,e.$axios.delete("/favorite/"+t.id);case 5:return n.next=7,e.$store.dispatch("getShops");case 7:e.$emit("changeFav"),e.processing=!1;case 9:case"end":return n.stop()}}),n)})))()}}}),c=(n(311),n(27)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"card",style:"width:"+t.width+"%",attrs:{shop:t.shop,width:t.width}},["development"==t.$config.nodeEnv?o("img",{staticClass:"card-img",attrs:{src:t._f("imagePathFormat")(t.shop.images[0].path,t.$config.apiURL),alt:"#"}}):o("img",{staticClass:"card-img",attrs:{src:t._f("imagePathFormatProduction")(t.shop.images[0].path,t.$config.awsURL),alt:""}}),t._v(" "),o("div",{staticClass:"card-content"},[o("p",{staticClass:"card-name"},[t._v(t._s(t.shop.name))]),t._v(" "),o("span",{staticClass:"card-tag"},[t._v("#"+t._s(t.shop.area))]),t._v(" "),o("span",{staticClass:"card-tag"},[t._v("#"+t._s(t.shop.genre))]),t._v(" "),o("div",[o("NuxtLink",{staticClass:"card-detail-btn",attrs:{to:{path:"detail/"+t.shop.id}}},[t._v("詳しく見る")]),t._v(" "),t.$auth.loggedIn&&t.shop.favorites[0]?o("img",{staticClass:"fav-btn",attrs:{src:n(310)},on:{click:function(e){return t.unfavorite(t.shop.favorites[0])}}}):o("img",{staticClass:"fav-btn",attrs:{src:n(301)},on:{click:function(e){return t.favorite(t.shop.id)}}}),t._v(" "),t.$auth.loggedIn?t._e():o("img",{staticClass:"fav-btn",attrs:{src:n(301)}})],1)])])}),[],!1,null,null,null);e.default=component.exports},315:function(t,e,n){t.exports=n.p+"img/close.0e5cc6d.png"},317:function(t,e,n){"use strict";n(309)},318:function(t,e,n){var o=n(55)(!1);o.push([t.i,".booking_card{width:55%;color:#fff;border-radius:5px;background-color:#4169e1;padding:5px 10px;margin-bottom:20px;position:relative}.booking_card_ttl{font-size:20px;line-height:1.5em}.checked{margin-left:10px;background:#ff6868;padding:3px 6px;border-radius:5px;font-size:15px}.checkout{margin-left:10px;background:#f8a60e;border:none;border-radius:5px;color:#fff}.booking_card table{color:#fff;font-size:1em;padding:10px;margin:5px}.booking_card th{text-align:left;padding:5px 20px 5px 0}.close-btn{height:13%;position:absolute;top:7%;right:5%}.change-booking{display:inline-block;color:#fff;padding:10px}.qr-btn{background-color:inherit;border:none;color:#fff;display:block;font-size:15px}.qrcode-wrapper{position:absolute;top:0;left:0;width:100%;height:100%;background:#fff;z-index:9}.qrcode-content{width:70%;margin:0 auto;color:#000;text-align:center}.qr-close{display:block;margin:0 auto}@media screen and (max-width:768px){.booking_card{width:90%}}",""]),t.exports=o},326:function(t,e,n){var content=n(353);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("3309bdca",content,!0,{sourceMap:!1})},344:function(t,e,n){"use strict";n.r(e);var o=n(11),r=(n(39),n(303),n(47),n(327)),c={props:{booking:{type:Object},index:{type:Number}},data:function(){return{isShowQR:!1,qrcode:"",sendData:{user_id:this.$auth.user.id,shop_id:this.booking.shop.id,menu_id:this.booking.menu.id,booking_id:this.booking.id,number_of_people:this.booking.number_of_people},processing:!1}},filters:{formatTime:function(time){return time.slice(0,-3)}},mounted:function(){var t=this;r.toDataURL(this.$config.apiURL+"/admin/booking/"+this.booking.id,(function(e,n){if(e)throw e;t.qrcode=n}))},methods:{cancelBooking:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!n.processing){o.next=2;break}return o.abrupt("return");case 2:if(!confirm("予約"+e+"を削除してよろしいですか？")){o.next=7;break}return o.next=5,n.$axios.delete("/booking/"+t);case 5:return o.next=7,n.$store.dispatch("getMyBookings");case 7:case"end":return o.stop()}}),o)})))()},toggleIsShowQR:function(){this.isShowQR=!this.isShowQR},checkout:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.processing){e.next=3;break}return e.abrupt("return");case 3:if(!confirm("事前決済ページへ移動しますか？")){e.next=11;break}return t.processing=!0,e.next=7,t.$axios.post("/pay",t.sendData);case 7:return n=e.sent,o=n.data.data.id,e.next=11,t.$stripe.redirectToCheckout({sessionId:o}).then((function(t){console.log(t)}));case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0),t.processing=!1;case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))()}}},d=(n(317),n(27)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("section",{staticClass:"booking_card",attrs:{booking:t.booking,index:t.index}},[o("span",{staticClass:"booking_card_ttl"},[t._v("予約"+t._s(t.index+1))]),t._v(" "),1==t.booking.checked?o("span",{staticClass:"checked"},[t._v("(支払い済)")]):o("span",[o("button",{staticClass:"checkout",on:{click:t.checkout}},[t._v("事前決済をする")])]),t._v(" "),o("img",{staticClass:"close-btn",attrs:{src:n(315)},on:{click:function(e){return t.cancelBooking(t.booking.id,t.index+1)}}}),t._v(" "),o("table",[o("tr",[o("th",[t._v("Shop")]),t._v(" "),o("td",[t._v(t._s(t.booking.shop.name))])]),t._v(" "),o("tr",[o("th",[t._v("Date")]),t._v(" "),o("td",[t._v(t._s(t.booking.date))])]),t._v(" "),o("tr",[o("th",[t._v("Time")]),t._v(" "),o("td",[t._v(t._s(t._f("formatTime")(t.booking.time)))])]),t._v(" "),o("tr",[o("th",[t._v("Number")]),t._v(" "),o("td",[t._v(t._s(t.booking.number_of_people)+"人")])]),t._v(" "),o("tr",[o("th",[t._v("Menu")]),t._v(" "),o("td",[t._v(t._s(t.booking.menu.name))])])]),t._v(" "),o("NuxtLink",{staticClass:"change-booking",attrs:{to:{path:"bookings/"+t.booking.id}}},[t._v("日時、人数を変更する")]),t._v(" "),o("button",{staticClass:"qr-btn",on:{click:t.toggleIsShowQR}},[t._v("QRコードを表示")]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowQR,expression:"isShowQR"}],staticClass:"qrcode-wrapper"},[o("div",{staticClass:"qrcode-content"},[o("p",[t._v("こちらのQRコードを従業員にお見せください")]),t._v(" "),o("img",{attrs:{src:t.qrcode,alt:"QRcode"}}),t._v(" "),o("button",{staticClass:"qr-close",on:{click:t.toggleIsShowQR}},[t._v("閉じる")])])])],1)])}),[],!1,null,null,null);e.default=component.exports},352:function(t,e,n){"use strict";n(326)},353:function(t,e,n){var o=n(55)(!1);o.push([t.i,".mypage_wrapper{display:flex;justify-content:center;margin:30px auto 0}.user-name{font-size:30px;font-weight:700;text-align:center;position:absolute;top:5%;left:50%}.past-booking{margin-bottom:10px;display:block;color:#000}.booking-list{width:50%;margin:0 auto}.booking-list h2,.favorite-shops h2{font-size:25px;margin-bottom:20px}.favorite-shop_cards{display:flex;flex-wrap:wrap;position:relative}.favorite-shops{width:50%}@media screen and (max-width:768px){.user-name{font-size:20px;right:0}.mypage_wrapper{flex-direction:column}.booking-list{width:90%}.favorite-shops{margin:0 auto;width:95%}}",""]),t.exports=o},404:function(t,e,n){"use strict";n.r(e);var o=n(11),r=(n(39),{data:function(){return{width:45,shops:[]}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("getMyBookings");case 2:t.getFavoriteShops();case 3:case"end":return e.stop()}}),e)})))()},methods:{getFavoriteShops:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/favorite");case 2:n=e.sent,t.shops=n.data.data;case 4:case"end":return e.stop()}}),e)})))()}}}),c=(n(352),n(27)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"user-name"},[t._v(t._s(t.$auth.user.name)+"さん")]),t._v(" "),n("div",{staticClass:"mypage_wrapper"},[n("div",{staticClass:"booking-list"},[n("h2",[t._v("予約状況")]),t._v(" "),n("NuxtLink",{staticClass:"past-booking",attrs:{to:"/history"}},[t._v("( >過去の予約はこちら )")]),t._v(" "),t._l(t.$store.getters.getValidBookings,(function(t,e){return n("BookingInfo",{key:t.id,attrs:{booking:t,index:e}})}))],2),t._v(" "),n("div",{staticClass:"favorite-shops"},[n("h2",[t._v("お気に入り店舗")]),t._v(" "),n("div",{staticClass:"card-wrapper"},t._l(t.shops,(function(e){return n("Shop",{key:e.id,attrs:{shop:e,width:t.width},on:{changeFav:t.getFavoriteShops}})})),1)])])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{BookingInfo:n(344).default,Shop:n(314).default})}}]);
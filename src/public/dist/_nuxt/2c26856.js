(window.webpackJsonp=window.webpackJsonp||[]).push([[9,5],{313:function(e,t,r){var content=r(322);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(56).default)("0b110d40",content,!0,{sourceMap:!1})},321:function(e,t,r){"use strict";r(313)},322:function(e,t,r){var n=r(55)(!1);n.push([e.i,".review-content{padding:10px}.review-content_header{margin-bottom:10px}",""]),e.exports=n},339:function(e,t,r){var content=r(390);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(56).default)("e917ce0e",content,!0,{sourceMap:!1})},345:function(e,t,r){"use strict";r.r(t);var n={props:{review:{type:Object}}},o=(r(321),r(27)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"review-content",attrs:{review:e.review}},[r("p",{staticClass:"review-content_header"},[e._v("\n    名前："+e._s(e.review.user.name)+"\n    評価："+e._s(e.review.star)+"点/5点中\n  ")]),e._v(" "),r("p",[e._v(e._s(e.review.comment))])])}),[],!1,null,null,null);t.default=component.exports},389:function(e,t,r){"use strict";r(339)},390:function(e,t,r){var n=r(55)(!1);n.push([e.i,".detail-wrapper{display:flex;justify-content:space-around;margin-bottom:50px}.shop-detail{width:40%}.back-btn{display:inline-block;width:20px;background-color:#fff;box-shadow:3px 3px 3px rgba(0,0,0,.3)}.back-btn a{text-decoration:none}.shop-name{font-size:25px;margin-bottom:20px}.shop-detail_img{width:100%;height:auto}.shop-tag{margin:10px 1px 20px 5px}.shop-intro{font-size:1em;line-height:1.5rem;margin-top:10px}.booking-form{width:40%;background-color:#4169e1;color:#fff;position:relative;padding:0 20px;border-radius:10px;overflow:hidden}.booking-form input,.booking-form select{display:block;height:30px;margin-bottom:10px}.booking-form input{width:200px}.booking-form select{width:80%}.booking-ttl{font-size:25px;margin:20px 0}.booking-table{color:#fff;background-color:#75a9ff;width:80%;margin:50px auto 70px}.booking-table td,.booking-table th{padding:10px;font-size:1em}.booking-table th{width:30%;text-align:left}.btn-block{display:flex;height:50px}.checkout-btn{background-color:#ffa600}.booking-btn,.checkout-btn{display:inline-block;width:50%;height:100%;font-size:16px;border:none;color:#fff;cursor:pointer}.booking-btn{background-color:#00f}.error{font-size:15px;color:#fa0f42;margin-bottom:5px}.review-wrapper{margin:0 auto;width:90%}.review-wrapper h2{font-size:30px;margin:20px 0}.review-no-exist{font-size:1em}.review-item{width:90%;margin:0 auto;border:1px solid #adacac;border-top:none}.review-item:first-of-type{border-top:1px solid #adacac}@media screen and (max-width:768px){.detail-wrapper{flex-direction:column}.shop-detail{width:90%;margin-bottom:10px}.booking-form{width:90%}.booking-table{width:100%;margin:30px auto}}",""]),e.exports=n},408:function(e,t,r){"use strict";r.r(t);var n=r(11),o=(r(39),r(42),r(19),r(47),r(40),r(48),r(199),r(50),{data:function(){return{errors:{date:"",number:"",menu_id:"",hasOtherBooking:"",remainingSeats:""},shop:"",imagePath:"",reviews:"",timeList:[],numberList:[],fromDate:"",untilDate:"",date:"",time:"11:00",number:"1人",menu:"メニューを選んでください",selectedMenuId:"",sendData:{},processing:!1}},mounted:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,i,l,d,m,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/shops/"+e.$route.params.shopId);case 2:for(r=t.sent,e.shop=r.data.data,n=e.shop.images.filter((function(e){return"トップ"==e.type})),e.imagePath=n[0].path,e.reviews=e.shop.reviews,o=new Date,c=new Date,o.setDate(o.getDate()+1),c.setMonth(c.getMonth()+1),e.fromDate=o.toISOString().slice(0,10),e.untilDate=c.toISOString().slice(0,10),i=11;i<=21;i++)l=i+":00",e.timeList.push(l),d=i+":30",e.timeList.push(d);for(m=1;m<=e.shop.number_of_seats;m++)v=m+"人",e.numberList.push(v);case 15:case"end":return t.stop()}}),t)})))()},methods:{setSendData:function(){var e=this;if(Object.keys(this.errors).forEach((function(t){e.errors[t]=""})),"メニューを選んでください"!=this.menu){var t=this.shop.menus.find((function(t){return t.name==e.menu}));this.selectedMenuId=t.id}this.sendData={user_id:this.$auth.user.id,shop_id:this.shop.id,menu_id:this.selectedMenuId,date:this.date,time:this.time,number_of_people:this.number.slice(0,-1)}},book:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.processing){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,e.setSendData(),!confirm("この内容で予約してよろしいですか？")){t.next=9;break}return e.processing=!0,t.next=8,e.$axios.post("/booking",e.sendData);case 8:e.$router.push("/done");case 9:t.next=16;break;case 11:t.prev=11,t.t0=t.catch(2),r=t.t0.response.data,Object.keys(r.errors).forEach((function(t){e.errors[t]=r.errors[t][0]})),e.processing=!1;case 16:case"end":return t.stop()}}),t,null,[[2,11]])})))()},checkout:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.processing){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,e.setSendData(),!confirm("この内容で予約してよろしいですか？　予約完了後、事前決済ページへ移動します")){t.next=13;break}return e.processing=!0,t.next=8,e.$axios.post("/booking",e.sendData);case 8:return r=t.sent,n=r.data.data.id,e.sendData.booking_id=n,t.next=13,e.redirectToCheckout(e.sendData);case 13:t.next=20;break;case 15:t.prev=15,t.t0=t.catch(2),o=t.t0.response.data,Object.keys(o.errors).forEach((function(t){e.errors[t]=o.errors[t][0]})),e.processing=!1;case 20:case"end":return t.stop()}}),t,null,[[2,15]])})))()},redirectToCheckout:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$axios.post("/pay",e);case 3:return n=r.sent,o=n.data.data.id,console.log(o),r.next=8,t.$stripe.redirectToCheckout({sessionId:o}).then((function(e){console.log(e)}));case 8:r.next=14;break;case 10:r.prev=10,r.t0=r.catch(0),console.log(r.t0),t.processing=!1;case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()}},filters:{imagePathFormat:function(path,e){return e+"/storage/images/"+path},imagePathFormatProduction:function(path,e){return e+"/"+path}}}),c=(r(389),r(27)),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"detail-wrapper"},[r("div",{staticClass:"shop-detail"},[r("p",{staticClass:"shop-name"},[r("span",{staticClass:"back-btn"},[r("a",{on:{click:function(t){return e.$router.back()}}},[e._v("<")])]),e._v("\n        "+e._s(e.shop.name)+"\n      ")]),e._v(" "),"development"==e.$config.nodeEnv?r("img",{staticClass:"card-img",attrs:{src:e._f("imagePathFormat")(e.imagePath,e.$config.apiURL),alt:"#"}}):r("img",{staticClass:"card-img",attrs:{src:e._f("imagePathFormatProduction")(e.imagePath,e.$config.awsURL),alt:"#"}}),e._v(" "),r("div",{staticClass:"shop-tag"},[r("span",[e._v("#"+e._s(e.shop.area))]),e._v(" "),r("span",[e._v("#"+e._s(e.shop.genre))])]),e._v(" "),r("NuxtLink",{attrs:{to:{path:"/photo/"+e.shop.id},replace:""}},[e._v("→店舗写真を見る")]),e._v(" "),r("p",{staticClass:"shop-intro"},[e._v(e._s(e.shop.detail))])],1),e._v(" "),r("div",{staticClass:"booking-form"},[r("p",{staticClass:"booking-ttl"},[e._v("予約")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.date,expression:"date"}],attrs:{type:"date",name:"date",min:e.fromDate,max:e.untilDate,required:""},domProps:{value:e.date},on:{input:function(t){t.target.composing||(e.date=t.target.value)}}}),e._v(" "),r("p",{staticClass:"error"},[e._v(e._s(e.errors.date))]),e._v(" "),r("p",{staticClass:"error"},[e._v(e._s(e.errors.hasOtherBooking))]),e._v(" "),r("p",{staticClass:"error"},[e._v(e._s(e.errors.remainingSeats))]),e._v(" "),r("p",{staticClass:"error"},[e._v(e._s(e.errors.menu_id))]),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.time,expression:"time"}],attrs:{name:"time",id:"time"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.time=t.target.multiple?r:r[0]}}},e._l(e.timeList,(function(time){return r("option",{key:time,domProps:{value:time}},[e._v(e._s(time))])})),0),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.number,expression:"number"}],attrs:{name:"number_of_people",id:"number"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.number=t.target.multiple?r:r[0]}}},e._l(e.numberList,(function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])})),0),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.menu,expression:"menu"}],attrs:{name:"menu",id:"menu"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.menu=t.target.multiple?r:r[0]}}},[r("option",{attrs:{selected:""}},[e._v("メニューを選んでください")]),e._v(" "),e._l(e.shop.menus,(function(menu){return r("option",{key:menu.id,domProps:{value:menu.name}},[e._v(e._s(menu.name))])}))],2),e._v(" "),r("table",{staticClass:"booking-table"},[r("tr",[r("th",[e._v("Shop")]),e._v(" "),r("td",[e._v(e._s(e.shop.name))])]),e._v(" "),r("tr",[r("th",[e._v("Date")]),e._v(" "),r("td",[e._v(e._s(e.date))])]),e._v(" "),r("tr",[r("th",[e._v("Time")]),e._v(" "),r("td",[e._v(e._s(e.time))])]),e._v(" "),r("tr",[r("th",[e._v("Number")]),e._v(" "),r("td",[e._v(e._s(e.number))])]),e._v(" "),r("tr",[r("th",[e._v("Menu")]),e._v(" "),r("td",[e._v(e._s(e.menu))])])]),e._v(" "),r("div",{staticClass:"btn-block"},[r("button",{staticClass:"checkout-btn",on:{click:e.checkout}},[e._v("事前決済はこちら")]),e._v(" "),r("button",{staticClass:"booking-btn",on:{click:e.book}},[e._v("予約する")])])])]),e._v(" "),r("div",{staticClass:"review-wrapper"},[r("h2",[e._v("口コミ")]),e._v(" "),e.reviews.length?e._e():r("p",{staticClass:"review-no-exist"},[e._v("このお店の口コミはまだありません。")]),e._v(" "),e._l(e.reviews,(function(e){return r("Review",{key:e.id,staticClass:"review-item",attrs:{review:e}})}))],2)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Review:r(345).default})}}]);